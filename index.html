<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="style.css">
  <script type="module" src="app.js"></script>
</head>
<body>
  <div x-data="faqComponent()"
       x-init="init()"
      @keydown.escape="closeAll()"
      @keydown.arrow-up.prevent="navigateUp()"
      @keydown.arrow-down.prevent="navigateDown()"
      @keydown.enter="toggleCurrent()"
      tabindex="0"
      class="max-w-2xl mx-auto mt-8 space-y-4">
    <input 
      type="text" 
      x-model="searchTerm"
      x-ref="searchInput" 
      placeholder="搜尋 FAQ..." 
      class="w-full p-3 border border-gray-300 rounded-lg mb-6">
    <div class="flex gap-2 mb-4">
      <template x-for="category in $store.faqStore.categories">
        <button
          @click="$store.faqStore.currentCategory = category"
          :class="$store.faqStore.currentCategory === category ? 'bg-blue-500 text-white' : 'bg-gray-200'"
          x-text="category"
          class="px-4 py-2 rounded-lg">
        </button>
      </template>
    </div>
    <!-- 載入中的狀態 -->
    <div 
      x-show="isLoading"
      x-transition
      class="text-center py-8">
      <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-4"></div>
      <p x-text="loadingText" class="text-gray-600"></p>
    </div>
    <div x-show="!isLoading"
         x-transition:enter="transition-all duration-500 ease-out"
         x-transition:enter-start="opacity-0 transform translate-x-4"
         x-transition:enter-end="opacity-100 transform translate-x-0"
         class="space-y-4">
      <template x-for="(faq, index) in filteredFaqs" :key="index">
        <div
          :class="index === currentIndex ? 'ring-2 ring-blue-500' : ''" 
          class="border border-gray-200 rounded-lg overflow-hidden">
          <h3 
            @click="animateToggle(faq)" 
            :class="faq.isAnimating ? 'scale-95' : 'scale-100'"
            class="bg-gray-50 px-6 py-4 cursor-pointer hover:bg-gray-100 transition-colors duration-200 flex justify-between items-center">
            <span x-text="faq.question"></span>
            <span 
              x-text="faq.isOpen ? '▲' : '▼'"
              :class="faq.isAnimating ? 'rotate-180' : ''"
              class="transition-transform duration-300"></span>
          </h3>
          <p x-show="faq.isOpen"
             x-transition:enter="transition ease-out duration-300"
             x-transition:enter-start="opacity-0 transform -translate-y-2 scale-95"
             x-transition:enter-end="opacity-100 transform translate-y-0 scale-100"
             x-transition:leave="transition ease-in duration-200"
             x-transition:leave-start="opacity-100 transform translate-y-0 scale-100"
             x-transition:leave-end="opacity-0 transform -translate-y-2 scale-95"
             x-text="faq.answer" 
             class="bg-white px-6 py-4 border-t border-gray-200"></p>
        </div>
      </template>
    </div>
  </div>
</body>
</html>